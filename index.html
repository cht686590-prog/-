<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>午餐訂購彙整系統</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, addDoc, setDoc, updateDoc, deleteDoc, onSnapshot, collection, query, where, getDocs, writeBatch } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // 設定 Firebase Debug Log
        setLogLevel('Debug');

        // 全域變數，由 Canvas 環境提供
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        
        // 初始化 Firebase
        let app = null;
        let db = null;
        let auth = null;
        
        let userId = null;
        let isAdmin = false;

        // 系統狀態
        let menuItems = [];
        let orders = [];
        let qrCodeUrl = null;
        let showModal = false;
        let modalContent = '';
        let showReportModal = false;
        let selectedItem = null;
        let currentPage = 'main';

        const welcomeMessages = [
            "您好，再忙也不能忘記吃飯，今天想吃什麼呢？",
            "肚子餓了嗎？看看今天的午餐菜單吧！",
            "點餐時間到了！希望您能找到想吃的美味。",
            "歡迎回來！今天午餐想來點什麼特別的？",
            "午餐訂購系統已啟動，祝您用餐愉快！"
        ];

        const uiElements = {
            mainPage: document.getElementById('main-page'),
            adminPage: document.getElementById('admin-page'),
            loadingOverlay: document.getElementById('loading-overlay'),
            adminSection: document.getElementById('admin-section'),
            userSection: document.getElementById('user-section'),
            reportSection: document.getElementById('report-section'),
            menuDisplay: document.getElementById('menu-display'),
            ordersDisplay: document.getElementById('orders-display'),
            orderModal: document.getElementById('order-modal'),
            modalTitle: document.getElementById('modal-title'),
            modalBody: document.getElementById('modal-body'),
            closeModalBtn: document.getElementById('close-modal'),
            dailyReportModal: document.getElementById('daily-report-modal'),
            dailyReportContent: document.getElementById('daily-report-content'),
            closeReportModalBtn: document.getElementById('close-report-modal'),
            adminPasswordInput: document.getElementById('admin-password'),
            adminLoginBtn: document.getElementById('admin-login-btn')
        };

        // UI 渲染與互動
        const renderUI = () => {
            uiElements.mainPage.classList.toggle('hidden', currentPage !== 'main');
            uiElements.adminPage.classList.toggle('hidden', currentPage !== 'admin');
            renderMenu();
            renderOrders();
            uiElements.orderModal.classList.toggle('hidden', !showModal);
            uiElements.dailyReportModal.classList.toggle('hidden', !showReportModal);
        };

        const setLoading = (isLoading, message = '處理中...') => {
            if (isLoading) {
                uiElements.loadingOverlay.classList.remove('hidden');
                uiElements.loadingOverlay.querySelector('span').textContent = message;
            } else {
                uiElements.loadingOverlay.classList.add('hidden');
            }
        };

        const renderMenu = () => {
            const menuHtml = menuItems.map(item => `
                <div class="bg-white p-4 rounded-xl shadow-md flex justify-between items-center transition-transform hover:scale-105 cursor-pointer" onclick="handleItemClick('${item.item.replace(/'/g, "\\'")}', ${item.price})">
                    <span class="text-xl font-bold text-gray-800">${item.item}</span>
                    <span class="text-xl font-bold text-red-500">NT$${item.price}</span>
                </div>
            `).join('');
            uiElements.menuDisplay.innerHTML = menuHtml || '<p class="text-center text-gray-500">目前沒有菜單，請等待管理者上傳。</p>';
        };

        const renderOrders = () => {
            if (orders.length === 0) {
                uiElements.ordersDisplay.innerHTML = '<p class="text-center text-gray-500">目前沒有任何訂單。</p>';
                return;
            }

            const ordersHtml = orders.map(order => `
                <div class="bg-white p-4 rounded-xl shadow-md mb-2 flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div>
                        <span class="font-bold text-gray-800">${order.name}</span> (${order.unit}) 點了 <span class="font-bold text-blue-500">${order.item}</span> (NT$${order.price})
                        <div class="text-sm text-gray-400">
                            時間: ${new Date(order.timestamp).toLocaleString()}
                        </div>
                    </div>
                    <div class="mt-2 sm:mt-0 flex items-center space-x-2">
                        <span class="font-bold ${order.isPaid ? 'text-green-500' : 'text-orange-500'}">
                            ${order.isPaid ? '已付款' : '未付款'}
                        </span>
                        ${!order.isPaid && isAdmin ? `
                            <button onclick="markAsPaid('${order.id}')" class="bg-blue-500 text-white p-2 rounded-full shadow-md text-sm hover:bg-blue-600 transition-colors">
                                標記為已付款
                            </button>
                        ` : ''}
                    </div>
                </div>
            `).join('');
            uiElements.ordersDisplay.innerHTML = ordersHtml;
        };

        const showReport = async () => {
            setLoading(true, '產生報告中...');
            
            const totalReport = {};
            const unitReport = {};
            let grandTotal = 0;
            let totalItems = 0;

            orders.forEach(order => {
                // 彙整總報告
                if (!totalReport[order.item]) {
                    totalReport[order.item] = { count: 0, totalAmount: 0 };
                }
                totalReport[order.item].count++;
                totalReport[order.item].totalAmount += order.price;
                grandTotal += order.price;
                totalItems++;

                // 彙整單位報告
                if (!unitReport[order.unit]) {
                    unitReport[order.unit] = { count: 0, totalAmount: 0, orders: [] };
                }
                unitReport[order.unit].count++;
                unitReport[order.unit].totalAmount += order.price;
                unitReport[order.unit].orders.push(order);
            });
            
            let reportHtml = `
                <h3 class="text-2xl font-bold mb-4 text-center">每日訂單彙整報告</h3>
                <div class="space-y-6">
                    <div class="p-4 bg-blue-100 rounded-lg text-center">
                        <p class="text-2xl font-bold text-blue-800">總訂單數: <span class="text-red-500">${totalItems}</span></p>
                        <p class="text-2xl font-bold text-blue-800">總金額: <span class="text-red-500">NT$${grandTotal}</span></p>
                    </div>

                    <div class="p-4 bg-gray-100 rounded-lg">
                        <h4 class="text-xl font-semibold mb-2">品項總計</h4>
                        ${Object.keys(totalReport).map(item => `
                            <div class="flex justify-between items-center mb-1">
                                <span class="font-medium">${item} x ${totalReport[item].count}</span>
                                <span class="font-bold">NT$${totalReport[item].totalAmount}</span>
                            </div>
                        `).join('')}
                    </div>

                    <div class="p-4 bg-gray-100 rounded-lg">
                        <h4 class="text-xl font-semibold mb-2">各單位訂單彙整</h4>
                        ${Object.keys(unitReport).map(unit => `
                            <div class="bg-white p-3 rounded-lg shadow-sm mb-4">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-lg font-bold">${unit}</span>
                                    <div class="text-sm font-semibold text-gray-600">
                                        <span class="mr-2">總數: ${unitReport[unit].count}</span>
                                        <span>總金額: NT$${unitReport[unit].totalAmount}</span>
                                    </div>
                                </div>
                                <ul class="list-disc list-inside space-y-1 text-gray-700">
                                    ${unitReport[unit].orders.map(order => `
                                        <li>${order.name}: ${order.item} (NT$${order.price}) - ${new Date(order.timestamp).toLocaleString()}</li>
                                    `).join('')}
                                </ul>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            uiElements.dailyReportContent.innerHTML = reportHtml;
            showReportModal = true;
            renderUI();
            setLoading(false);
        };

        window.handleItemClick = (item, price) => {
            selectedItem = { item, price };
            uiElements.modalTitle.textContent = '填寫訂購資訊';
            uiElements.modalBody.innerHTML = `
                <p class="mb-4 text-center">您選擇了：<span class="font-bold text-blue-500">${item}</span> (NT$${price})</p>
                <form id="order-form" class="space-y-4">
                    <input type="text" id="order-name" placeholder="請輸入您的姓名" required class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <input type="text" id="order-unit" placeholder="請輸入您的單位 (例如: 固設處)" required class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <div class="flex items-center space-x-4">
                        <label class="flex items-center space-x-2">
                            <input type="radio" name="payment-method" value="Cash" checked class="form-radio text-blue-600">
                            <span>現金支付</span>
                        </label>
                        <label class="flex items-center space-x-2">
                            <input type="radio" name="payment-method" value="LINE PAY" class="form-radio text-green-600">
                            <span>LINE PAY</span>
                        </label>
                    </div>
                    <button type="submit" class="w-full bg-blue-500 text-white p-3 rounded-lg font-semibold hover:bg-blue-600 transition-colors">送出訂單</button>
                </form>
            `;
            showModal = true;
            renderUI();
            document.getElementById('order-form').addEventListener('submit', handleOrderSubmit);
        };

        const handleOrderSubmit = async (e) => {
            e.preventDefault();
            setLoading(true, '送出訂單中...');
            
            const name = document.getElementById('order-name').value;
            const unit = document.getElementById('order-unit').value;
            const paymentMethod = document.querySelector('input[name="payment-method"]:checked').value;

            try {
                const orderData = {
                    item: selectedItem.item,
                    price: selectedItem.price,
                    name: name,
                    unit: unit,
                    paymentMethod: paymentMethod,
                    isPaid: false,
                    timestamp: new Date().toISOString()
                };

                const ordersRef = collection(db, `artifacts/${appId}/public/data/orders`);
                await addDoc(ordersRef, orderData);

                showModal = false;
                setLoading(false);
                
                if (paymentMethod === 'LINE PAY') {
                    showLinePayQrCode();
                } else {
                    showMessage('訂單已送出', `您的訂單已送出，稍後請將現金交付給管理者。`);
                }

            } catch (error) {
                console.error("提交訂單失敗: ", error);
                setLoading(false);
                showMessage('錯誤', '提交訂單失敗，請稍後再試。');
            }
        };

        const showLinePayQrCode = async () => {
            setLoading(true, '載入 QR 碼...');
            try {
                const qrDoc = await getDoc(doc(db, `artifacts/${appId}/public/data/config`, 'qr_code'));
                const qrData = qrDoc.exists() ? qrDoc.data() : null;
                const qrUrl = qrData ? qrData.url : 'https://placehold.co/300x300/e5e7eb/6b7280?text=LINE+PAY+QR';

                uiElements.modalTitle.textContent = 'LINE PAY 收款';
                uiElements.modalBody.innerHTML = `
                    <div class="text-center space-y-4">
                        <p class="text-lg">請掃描下方 QR Code 完成支付。</p>
                        <img src="${qrUrl}" alt="LINE PAY QR Code" class="mx-auto rounded-lg shadow-md">
                        <p class="text-sm text-gray-500">由於系統限制，付款狀態需要管理者手動確認。</p>
                    </div>
                `;
                showModal = true;
                renderUI();
            } catch (error) {
                console.error("載入 QR 碼失敗:", error);
                showMessage('錯誤', '載入 QR 碼失敗，請稍後再試。');
            } finally {
                setLoading(false);
            }
        };

        const showMessage = (title, message) => {
            uiElements.modalTitle.textContent = title;
            uiElements.modalBody.innerHTML = `<p class="text-center">${message}</p>`;
            showModal = true;
            renderUI();
        };

        window.markAsPaid = async (orderId) => {
            if (!isAdmin) {
                showMessage('權限不足', '只有管理者可以標記訂單為已付款。');
                return;
            }
            setLoading(true, '更新訂單狀態...');
            try {
                const orderRef = doc(db, `artifacts/${appId}/public/data/orders`, orderId);
                await updateDoc(orderRef, { isPaid: true });
                setLoading(false);
            } catch (error) {
                console.error("更新訂單狀態失敗: ", error);
                setLoading(false);
                showMessage('錯誤', '更新狀態失敗，請檢查網路連線。');
            }
        };

        // 管理頁面功能
        window.goToAdminPage = () => {
            currentPage = 'admin';
            renderUI();
        };

        window.goToMainPage = () => {
            currentPage = 'main';
            renderUI();
        };

        window.checkAdminPassword = async () => {
            const password = uiElements.adminPasswordInput.value;
            if (password === '0000') {
                isAdmin = true;
                const adminRef = doc(db, `artifacts/${appId}/public/data/admins`, 'admin_id');
                await setDoc(adminRef, { uid: userId });
                uiElements.adminPage.innerHTML = `
                    <h2 class="text-2xl font-bold mb-4 text-blue-800">管理者設定</h2>
                    <div class="space-y-6">
                        <div class="bg-blue-100 p-4 rounded-xl shadow-md">
                            <h3 class="text-xl font-semibold mb-2">上傳菜單圖片</h3>
                            <div class="flex flex-col sm:flex-row items-center sm:space-x-4">
                                <input type="file" id="menu-image" accept="image/*" class="w-full sm:w-auto mb-2 sm:mb-0 p-3 rounded-xl border border-blue-300 bg-white">
                                <button onclick="handleImageUpload()" class="w-full sm:w-auto bg-blue-500 text-white p-3 rounded-xl font-semibold shadow-md hover:bg-blue-600 transition-colors">
                                    上傳菜單並辨識
                                </button>
                            </div>
                        </div>
                        <div class="bg-blue-100 p-4 rounded-xl shadow-md">
                            <h3 class="text-xl font-semibold mb-2">上傳 LINE PAY QR 碼</h3>
                            <div class="flex flex-col sm:flex-row items-center sm:space-x-4">
                                <input type="file" id="qr-code-image" accept="image/*" class="w-full sm:w-auto mb-2 sm:mb-0 p-3 rounded-xl border border-blue-300 bg-white">
                                <button onclick="handleQrCodeUpload()" class="w-full sm:w-auto bg-blue-500 text-white p-3 rounded-xl font-semibold shadow-md hover:bg-blue-600 transition-colors">
                                    上傳 QR 碼
                                </button>
                            </div>
                        </div>
                    </div>
                    <button onclick="goToMainPage()" class="mt-8 bg-gray-500 text-white p-3 rounded-xl font-semibold shadow-md hover:bg-gray-600 transition-colors w-full">
                        返回主頁
                    </button>
                `;
                renderOrders(); // 重新渲染訂單列表以顯示「標記為已付款」按鈕
            } else {
                showMessage('密碼錯誤', '請輸入正確的管理者密碼。');
            }
        };

        window.handleQrCodeUpload = async () => {
            const fileInput = document.getElementById('qr-code-image');
            const file = fileInput.files[0];
            if (!file) {
                showMessage('錯誤', '請先選擇一個圖片檔案。');
                return;
            }

            setLoading(true, '上傳 QR 碼中...');
            
            const reader = new FileReader();
            reader.onload = async (e) => {
                const base64Image = e.target.result;
                try {
                    await setDoc(doc(db, `artifacts/${appId}/public/data/config`, 'qr_code'), {
                        url: base64Image
                    });
                    showMessage('成功', 'LINE PAY QR 碼已成功上傳！');
                } catch (error) {
                    console.error("上傳 QR 碼失敗:", error);
                    showMessage('錯誤', `上傳 QR 碼失敗：${error.message}`);
                } finally {
                    setLoading(false);
                }
            };
            reader.readAsDataURL(file);
        };

        // 圖片上傳與文字辨識 (OCR)
        window.handleImageUpload = async () => {
            const fileInput = document.getElementById('menu-image');
            const file = fileInput.files[0];
            if (!file) {
                showMessage('錯誤', '請先選擇一個圖片檔案。');
                return;
            }

            setLoading(true, '上傳並辨識菜單中...');
            
            const reader = new FileReader();
            reader.onload = async (e) => {
                const base64Image = e.target.result.split(',')[1];
                try {
                    const extractedMenu = await callOcrApi(base64Image);
                    if (extractedMenu && extractedMenu.length > 0) {
                        await saveMenuToFirestore(extractedMenu);
                        showMessage('成功', '菜單已成功辨識並更新！');
                    } else {
                        showMessage('錯誤', '無法辨識菜單內容，請確認圖片清晰。');
                    }
                } catch (error) {
                    console.error("辨識菜單失敗: ", error);
                    showMessage('錯誤', `辨識菜單失敗：${error.message}`);
                } finally {
                    setLoading(false);
                }
            };
            reader.readAsDataURL(file);
        };

        const callOcrApi = async (base64Image) => {
            const systemPrompt = "請將圖片中的菜單內容轉換成 JSON 格式。每個項目包含 'item' (餐點名稱) 和 'price' (價格，數字)。忽略非菜單的資訊，例如電話號碼、地址、營業時間等。";
            const userPrompt = "請辨識這張菜單圖片，並整理成 JSON 格式。";
            const payload = {
                contents: [{
                    parts: [
                        { text: userPrompt },
                        { inlineData: { mimeType: "image/jpeg", data: base64Image } }
                    ]
                }],
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "ARRAY",
                        items: {
                            type: "OBJECT",
                            properties: {
                                "item": { "type": "STRING" },
                                "price": { "type": "NUMBER" }
                            }
                        }
                    }
                }
            };

            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            const result = await response.json();
            const jsonText = result?.candidates?.[0]?.content?.parts?.[0]?.text;
            if (jsonText) {
                return JSON.parse(jsonText);
            }
            return [];
        };

        const saveMenuToFirestore = async (newMenu) => {
            const menuRef = collection(db, `artifacts/${appId}/public/data/menus`);
            const existingDocs = await getDocs(menuRef);
            
            const batch = writeBatch(db);
            existingDocs.forEach(doc => {
                batch.delete(doc.ref);
            });
            
            newMenu.forEach(item => {
                batch.set(doc(menuRef), item);
            });

            await batch.commit();
        };

        // 頁面加載後初始化
        window.onload = async () => {
            if (!firebaseConfig) {
                // 如果沒有 Firebase 設定，顯示錯誤訊息並禁用功能
                document.body.innerHTML = `
                    <div class="fixed inset-0 bg-gray-100 flex items-center justify-center p-4 text-center">
                        <div class="bg-red-100 p-8 rounded-xl shadow-lg border-2 border-red-400">
                            <h1 class="text-3xl font-bold text-red-600 mb-4">系統無法運作</h1>
                            <p class="text-lg text-red-500 mb-6">這個應用程式需要一個特殊的部署環境來連接資料庫。<br>請將程式碼部署到 Google 的服務 (例如 **Firebase Hosting**) 以正常使用。</p>
                            <p class="text-gray-500 text-sm">錯誤碼: F-01</p>
                        </div>
                    </div>
                `;
                return;
            }

            setLoading(true, '系統初始化中...');

            // Firebase 認證
            try {
                app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }
            } catch (error) {
                console.error("Firebase 認證失敗:", error);
            }

            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    userId = user.uid;
                    
                    // 檢查是否為管理者
                    const adminRef = doc(db, `artifacts/${appId}/public/data/admins`, 'admin_id');
                    const adminDoc = await getDoc(adminRef);
                    if (!adminDoc.exists()) {
                        // 如果沒有管理者，則將第一個登入的使用者設為管理者
                        await setDoc(adminRef, { uid: userId });
                        isAdmin = true;
                    } else {
                        // 檢查當前使用者是否為管理者
                        isAdmin = adminDoc.data().uid === userId;
                    }

                    const randomIndex = Math.floor(Math.random() * welcomeMessages.length);
                    document.getElementById('welcome-message').textContent = welcomeMessages[randomIndex];

                    // 監聽菜單變化
                    onSnapshot(collection(db, `artifacts/${appId}/public/data/menus`), (snapshot) => {
                        menuItems = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                        renderUI();
                    });

                    // 監聽訂單變化
                    onSnapshot(collection(db, `artifacts/${appId}/public/data/orders`), (snapshot) => {
                        orders = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                        renderUI();
                    });
                } else {
                    console.log("未登入或匿名使用者");
                }
                setLoading(false);
            });
        };

        // 事件監聽
        document.getElementById('show-report-btn').addEventListener('click', showReport);
        uiElements.closeModalBtn.addEventListener('click', () => { showModal = false; renderUI(); });
        uiElements.closeReportModalBtn.addEventListener('click', () => { showReportModal = false; renderUI(); });
    </script>
</head>
<body class="bg-gray-100 font-sans text-gray-800">

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex flex-col items-center justify-center z-50 hidden">
        <div class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-white"></div>
        <span class="mt-4 text-white text-lg">處理中...</span>
    </div>

    <!-- 主頁面 -->
    <div id="main-page" class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-blue-600 mb-2">午餐共編訂購系統</h1>
            <p id="welcome-message" class="text-lg text-gray-500"></p>
        </header>

        <main id="user-section">
            <!-- 菜單顯示區塊 -->
            <section class="mb-8">
                <h2 class="text-2xl font-bold mb-4">今日菜單</h2>
                <div id="menu-display" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Menu items will be rendered here by JS -->
                </div>
            </section>

            <!-- 訂單顯示區塊 -->
            <section class="mb-8">
                <h2 class="text-2xl font-bold mb-4">所有人的訂單</h2>
                <div id="orders-display" class="space-y-2">
                    <!-- Orders will be rendered here by JS -->
                </div>
            </section>
        </main>
        
        <!-- 底部功能按鈕 -->
        <section class="fixed bottom-4 left-4 right-4 flex justify-between space-x-4">
            <button onclick="goToAdminPage()" class="bg-orange-500 text-white p-4 rounded-full shadow-lg font-bold hover:bg-orange-600 transition-colors">
                管理者登入
            </button>
            <button id="show-report-btn" class="bg-green-500 text-white p-4 rounded-full shadow-lg font-bold hover:bg-green-600 transition-colors">
                查看每日彙整報告
            </button>
        </section>
    </div>

    <!-- 管理頁面 -->
    <div id="admin-page" class="fixed inset-0 bg-gray-100 p-4 sm:p-6 lg:p-8 hidden">
        <div class="container mx-auto">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-blue-600 mb-8 text-center">管理者頁面</h1>
            <div id="admin-login" class="bg-white p-6 rounded-3xl shadow-lg max-w-sm mx-auto text-center">
                <h2 class="text-2xl font-bold mb-4">請輸入管理者密碼</h2>
                <input type="password" id="admin-password" placeholder="密碼" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4">
                <button onclick="checkAdminPassword()" id="admin-login-btn" class="w-full bg-blue-500 text-white p-3 rounded-lg font-semibold shadow-md hover:bg-blue-600 transition-colors">
                    登入
                </button>
            </div>
            <!-- 管理者功能區塊將在登入後動態載入 -->
        </div>
    </div>


    <!-- 訂購 Modal -->
    <div id="order-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center p-4 z-40 hidden">
        <div class="bg-white rounded-3xl shadow-2xl p-6 w-full max-w-sm transform transition-all scale-100">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h3 id="modal-title" class="text-2xl font-bold"></h3>
                <button id="close-modal" class="text-gray-400 hover:text-gray-600 transition-colors">&times;</button>
            </div>
            <div id="modal-body">
                <!-- Modal content will be dynamically generated here -->
            </div>
        </div>
    </div>
    
    <!-- 每日報告 Modal -->
    <div id="daily-report-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center p-4 z-40 hidden">
        <div class="bg-white rounded-3xl shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto transform transition-all scale-100">
            <div class="flex justify-end">
                <button id="close-report-modal" class="text-gray-400 hover:text-gray-600 transition-colors">&times;</button>
            </div>
            <div id="daily-report-content">
                <!-- Report content will be dynamically generated here -->
            </div>
        </div>
    </div>

</body>
</html>
